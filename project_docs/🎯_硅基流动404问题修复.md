# ğŸ¯ ç¡…åŸºæµåŠ¨ 404 é—®é¢˜ä¿®å¤

## âŒ é—®é¢˜ç—‡çŠ¶

- **è¡¨ç°**: å¯¹è¯æœ‰å›å¤ï¼Œä½†å†…å®¹ä¸ºç©º
- **æ—¥å¿—**: æ—  API è¯·æ±‚æ—¥å¿—ï¼Œä»»åŠ¡å¿«é€Ÿå®Œæˆï¼ˆ200msï¼‰
- **ä¼šè¯æ—¥å¿—**: 
  ```json
  {
    "role": "assistant",
    "content": [],           // ç©ºå†…å®¹
    "stopReason": "error",
    "errorMessage": "404 Not Found"
  }
  ```

---

## ğŸ” é—®é¢˜è¯Šæ–­

### 1. æŸ¥çœ‹æ—¥å¿—ä½ç½®

#### ä¸»ç½‘å…³æ—¥å¿—
```bash
tail -f /tmp/wukongbot-gateway.log
```

#### è¯¦ç»†æ—¥å¿—
```bash
tail -f /tmp/moltbot/moltbot-2026-01-28.log
```

#### ä¼šè¯æ—¥å¿—
```bash
ls ~/.clawdbot/agents/main/sessions/
cat ~/.clawdbot/agents/main/sessions/<session-id>.jsonl
```

### 2. é—®é¢˜å‘ç°

ä»ä¼šè¯æ—¥å¿— `/root/.clawdbot/agents/main/sessions/d790d12b-1084-47f1-aeae-4b00ec4af8f3.jsonl` ä¸­å‘ç°ï¼š

```json
{
  "type": "message",
  "id": "83888e49",
  "message": {
    "role": "assistant",
    "content": [],
    "stopReason": "error",
    "errorMessage": "404 Not Found"  // âŒ API è¿”å› 404
  }
}
```

è¿™è¯´æ˜ï¼š
- âœ… API è¯·æ±‚ç¡®å®å‘é€åˆ°äº†ç¡…åŸºæµåŠ¨
- âŒ ä½†è¿”å›äº† 404 é”™è¯¯

---

## ğŸ§ª API æµ‹è¯•

### æµ‹è¯• 1: ä½¿ç”¨å®Œæ•´æ¨¡å‹å

```bash
curl -X POST https://api.siliconflow.cn/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-fymrvjkuzxgqxmzctrbhwitoapmefcjnmabsgrogpqvwqbyd" \
  -d '{
    "model": "deepseek-ai/DeepSeek-V3",
    "messages": [{"role": "user", "content": "ä½ å¥½"}],
    "max_tokens": 20
  }'
```

**ç»“æœ**: âœ… **æˆåŠŸï¼**
```json
{
  "id": "019c031c79120d51fd39fd36e428dd6a",
  "object": "chat.completion",
  "model": "deepseek-ai/DeepSeek-V3",
  "choices": [{
    "message": {
      "role": "assistant",
      "content": "ä½ å¥½ï¼ğŸ˜Š å¾ˆé«˜å…´è§åˆ°ä½ ï½æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®å¿™çš„å—ï¼Ÿ"
    },
    "finish_reason": "stop"
  }],
  "usage": {
    "prompt_tokens": 4,
    "completion_tokens": 14,
    "total_tokens": 18
  }
}
```

### æµ‹è¯• 2: ä½¿ç”¨ç®€åŒ–æ¨¡å‹å

```bash
curl -X POST https://api.siliconflow.cn/v1/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-fymrvjkuzxgqxmzctrbhwitoapmefcjnmabsgrogpqvwqbyd" \
  -d '{
    "model": "DeepSeek-V3",
    "messages": [{"role": "user", "content": "ä½ å¥½"}],
    "max_tokens": 20
  }'
```

**ç»“æœ**: âŒ **å¤±è´¥ï¼**
```json
{
  "code": 20012,
  "message": "Model does not exist. Please check it carefully.",
  "data": null
}
```

---

## ğŸ’¡ æ ¹æœ¬åŸå› 

**é—®é¢˜**: é…ç½®ä¸­çš„æ¨¡å‹ `id` è®¾ç½®ä¸ºç®€åŒ–åç§° `DeepSeek-V3`ï¼Œä½†ç¡…åŸºæµåŠ¨è¦æ±‚å®Œæ•´åç§° `deepseek-ai/DeepSeek-V3`ã€‚

### é”™è¯¯é…ç½®

```json
{
  "models": {
    "providers": {
      "deepseek-ai": {
        "models": [
          {
            "id": "DeepSeek-V3",  // âŒ ç®€åŒ–åç§°
            "name": "DeepSeek V3"
          }
        ]
      }
    }
  }
}
```

å½“ç³»ç»Ÿå‘é€ API è¯·æ±‚æ—¶ï¼š
```
æ¨¡å‹å¼•ç”¨: deepseek-ai/DeepSeek-V3
          â†“
provider: deepseek-ai
model: DeepSeek-V3
          â†“
API è¯·æ±‚: {"model": "DeepSeek-V3"}  // âŒ é”™è¯¯ï¼ç¡…åŸºæµåŠ¨ä¸è¯†åˆ«
          â†“
å“åº”: 404 Not Found
```

### æ­£ç¡®é…ç½®

```json
{
  "models": {
    "providers": {
      "deepseek-ai": {
        "models": [
          {
            "id": "deepseek-ai/DeepSeek-V3",  // âœ… å®Œæ•´åç§°
            "name": "DeepSeek V3"
          }
        ]
      }
    }
  }
}
```

å½“ç³»ç»Ÿå‘é€ API è¯·æ±‚æ—¶ï¼š
```
æ¨¡å‹å¼•ç”¨: deepseek-ai/DeepSeek-V3
          â†“
provider: deepseek-ai
model: deepseek-ai/DeepSeek-V3
          â†“
API è¯·æ±‚: {"model": "deepseek-ai/DeepSeek-V3"}  // âœ… æ­£ç¡®ï¼
          â†“
å“åº”: 200 OK + æ­£å¸¸å†…å®¹
```

---

## âœ… è§£å†³æ–¹æ¡ˆ

### ä¿®å¤æ­¥éª¤

1. **æ›´æ–°é…ç½®æ–‡ä»¶**

ä¿®æ”¹ `~/.clawdbot/moltbot.json`ï¼š

```json
{
  "models": {
    "providers": {
      "deepseek-ai": {
        "baseUrl": "https://api.siliconflow.cn/v1",
        "apiKey": "${OPENAI_API_KEY}",
        "api": "openai-responses",
        "models": [
          {
            "id": "deepseek-ai/DeepSeek-V3",  // âœ… ä¿®æ”¹ï¼šä½¿ç”¨å®Œæ•´åç§°
            "name": "DeepSeek V3",
            "reasoning": false,
            "input": ["text"],
            "cost": {
              "input": 0,
              "output": 0,
              "cacheRead": 0,
              "cacheWrite": 0
            },
            "contextWindow": 128000,
            "maxTokens": 8192
          }
        ]
      }
    }
  }
}
```

2. **é‡å¯ç½‘å…³**

```bash
# åœæ­¢æ—§ç½‘å…³
pkill -9 -f "moltbot.*gateway"

# å¯åŠ¨æ–°ç½‘å…³
pnpm wukongbot gateway run --port 18789
```

3. **éªŒè¯é…ç½®**

```bash
pnpm wukongbot models status
```

åº”è¯¥çœ‹åˆ°ï¼š
```
Default       : deepseek-ai/DeepSeek-V3
- deepseek-ai effective=models.json:sk-fymrv...pqvwqbyd âœ“
```

---

## ğŸ‰ æµ‹è¯•éªŒè¯

### 1. è®¿é—® Control UI

```
http://127.0.0.1:18789/?token=1a1760cece3bcedbfda1f348b0671cd2d9d56f74c47a74a0
```

### 2. å‘é€æµ‹è¯•æ¶ˆæ¯

åœ¨ Chat é¡µé¢è¾“å…¥ï¼š
```
ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±
```

### 3. é¢„æœŸç»“æœ

- âœ… æ¶ˆæ¯æˆåŠŸå‘é€
- âœ… DeepSeek V3 è¿”å›æ­£å¸¸å›å¤ï¼ˆæœ‰å†…å®¹ï¼‰
- âœ… æ—  404 é”™è¯¯
- âœ… å¯¹è¯æµç•…

### 4. æŸ¥çœ‹æ—¥å¿—éªŒè¯

```bash
tail -f /tmp/moltbot/moltbot-2026-01-28.log | grep -i "provider\|api\|deepseek"
```

åº”è¯¥çœ‹åˆ°ç±»ä¼¼ï¼š
```
embedded run start: provider=deepseek-ai model=deepseek-ai/DeepSeek-V3
[API requestæˆåŠŸ]
embedded run done: durationMs=2000+
```

---

## ğŸ“ å…³é”®æ•™è®­

### 1. æ¨¡å‹åç§°æ ¼å¼

ä¸åŒ provider å¯¹æ¨¡å‹åç§°çš„è¦æ±‚ä¸åŒï¼š

| Provider | é…ç½®æ ¼å¼ | API è¯·æ±‚æ ¼å¼ | ç¤ºä¾‹ |
|----------|----------|--------------|------|
| **ç¡…åŸºæµåŠ¨** | `provider/model-name` | `provider/model-name` | `deepseek-ai/DeepSeek-V3` |
| **OpenAI** | `model-name` | `model-name` | `gpt-4` |
| **Anthropic** | `model-name` | `model-name` | `claude-3-opus` |

### 2. é…ç½®ç»“æ„

```json
{
  "agents": {
    "defaults": {
      "model": {
        "primary": "provider/model-id"  // â† å®Œæ•´å¼•ç”¨
      },
      "models": {
        "provider/model-id": {}  // â† å£°æ˜ä½¿ç”¨
      }
    }
  },
  "models": {
    "providers": {
      "provider": {  // â† provider é…ç½®
        "baseUrl": "...",
        "apiKey": "...",
        "models": [
          {
            "id": "provider/model-id"  // â† å¿…é¡»ä¸ API è¦æ±‚ä¸€è‡´ï¼
          }
        ]
      }
    }
  }
}
```

### 3. è°ƒè¯•æµç¨‹

å½“é‡åˆ° API è°ƒç”¨é—®é¢˜æ—¶ï¼š

1. **æŸ¥çœ‹ä¼šè¯æ—¥å¿—** â†’ æ‰¾åˆ°å…·ä½“é”™è¯¯ï¼ˆ404/401/500 ç­‰ï¼‰
2. **ç›´æ¥ curl æµ‹è¯•** â†’ éªŒè¯ API ç«¯ç‚¹å’Œæ¨¡å‹åç§°
3. **å¯¹æ¯”é…ç½®** â†’ ç¡®ä¿é…ç½®ä¸ API è¦æ±‚ä¸€è‡´
4. **é‡å¯ç½‘å…³** â†’ åº”ç”¨é…ç½®æ›´æ”¹
5. **å®é™…æµ‹è¯•** â†’ å‘é€æ¶ˆæ¯éªŒè¯

---

## ğŸ” å¸¸è§é”™è¯¯ä»£ç 

| é”™è¯¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| **404 Not Found** | æ¨¡å‹åç§°é”™è¯¯æˆ–ä¸å­˜åœ¨ | æ£€æŸ¥æ¨¡å‹åç§°æ ¼å¼ï¼Œä½¿ç”¨æ­£ç¡®çš„ provider/model |
| **401 Unauthorized** | API Key æ— æ•ˆæˆ–è¿‡æœŸ | æ£€æŸ¥ API Keyï¼Œé‡æ–°è·å– |
| **429 Too Many Requests** | è¯·æ±‚é¢‘ç‡è¿‡é«˜ | é™ä½è¯·æ±‚é¢‘ç‡æˆ–å‡çº§å¥—é¤ |
| **500 Server Error** | æœåŠ¡ç«¯é—®é¢˜ | ç­‰å¾…æœåŠ¡æ¢å¤æˆ–è”ç³»å®¢æœ |
| **ç©ºå“åº”** | Provider é…ç½®ç¼ºå¤± | æ£€æŸ¥ `models.providers` é…ç½® |

---

## ğŸ¯ å®Œæ•´é…ç½®å‚è€ƒ

```json
{
  "agents": {
    "defaults": {
      "model": {
        "primary": "deepseek-ai/DeepSeek-V3"
      },
      "models": {
        "deepseek-ai/DeepSeek-V3": {}
      },
      "workspace": "/root/clawd"
    }
  },
  "models": {
    "providers": {
      "deepseek-ai": {
        "baseUrl": "https://api.siliconflow.cn/v1",
        "apiKey": "${OPENAI_API_KEY}",
        "api": "openai-responses",
        "models": [
          {
            "id": "deepseek-ai/DeepSeek-V3",
            "name": "DeepSeek V3",
            "reasoning": false,
            "input": ["text"],
            "cost": {
              "input": 0,
              "output": 0,
              "cacheRead": 0,
              "cacheWrite": 0
            },
            "contextWindow": 128000,
            "maxTokens": 8192
          }
        ]
      }
    }
  },
  "gateway": {
    "port": 18789,
    "mode": "local",
    "bind": "loopback",
    "auth": {
      "mode": "token",
      "token": "1a1760cece3bcedbfda1f348b0671cd2d9d56f74c47a74a0"
    }
  }
}
```

ç¯å¢ƒå˜é‡ (`~/.clawdbot/.env`):
```bash
OPENAI_API_KEY=sk-fymrvjkuzxgqxmzctrbhwitoapmefcjnmabsgrogpqvwqbyd
```

---

## âœ… é—®é¢˜è§£å†³æ€»ç»“

- **åŸå› **: æ¨¡å‹ ID é…ç½®é”™è¯¯ï¼ˆ`DeepSeek-V3` è€Œé `deepseek-ai/DeepSeek-V3`ï¼‰
- **ç—‡çŠ¶**: API è¿”å› 404 Not Foundï¼Œå¯¹è¯å†…å®¹ä¸ºç©º
- **ä¿®å¤**: å°†æ¨¡å‹ ID æ”¹ä¸ºå®Œæ•´åç§°
- **éªŒè¯**: curl æµ‹è¯•æˆåŠŸï¼Œç½‘å…³é‡å¯æ­£å¸¸
- **çŠ¶æ€**: âœ… å·²ä¿®å¤ï¼Œå¯ä»¥æ­£å¸¸å¯¹è¯

---

**ä¿®å¤æ—¶é—´**: 2026-01-28 13:39  
**é—®é¢˜**: ç¡…åŸºæµåŠ¨æ¨¡å‹åç§°æ ¼å¼é”™è¯¯  
**ä¿®å¤**: ä½¿ç”¨å®Œæ•´æ¨¡å‹åç§° `deepseek-ai/DeepSeek-V3`  
**çŠ¶æ€**: âœ… å·²è§£å†³ï¼Œç½‘å…³è¿è¡Œä¸­
